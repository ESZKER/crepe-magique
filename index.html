<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Crepe Magique</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<style>
  /* ‚Äî‚Äî‚Äî STYLES (same as before) ‚Äî‚Äî‚Äî */
  body {font-family:"Poppins",sans-serif;background:#fffaf7;color:#4b2e2b;margin:0;padding:0;}
  header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background:white;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
  header img{height:120px;}
  button#viewOrdersBtn{background:none;border:none;color:#4b2e2b;font-weight:bold;cursor:pointer;}
  .banner{height:45vh;background:url('images/Banner.png')center/cover no-repeat;}
  h1{text-align:center;color:#3a1e1b;margin-top:20px;}
  main{display:flex;gap:30px;justify-content:space-between;padding:30px;}
  .menu{flex:2;display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;}
  .item{background:white;border:1px solid #e0cfc2;border-radius:12px;padding:10px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,0.05);}
  .item img{width:100%;border-radius:12px;height:160px;object-fit:cover;}
  .cart{flex:1;background:white;padding:20px;border:1px solid #e0cfc2;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.05);}
  .submit-btn{background:#4b2e2b;color:white;width:100%;border:none;border-radius:6px;padding:10px;margin-top:10px;cursor:pointer;}
  footer{text-align:center;background:#f5e7d8;padding:10px;margin-top:30px;}
</style>
</head>
<body>

<header>
  <div style="display:flex;align-items:center;gap:10px;">
    <img src="images/logo.png" alt="Crepe Magique Logo">
    <h2 style="font-family:'Playfair Display',serif;">Crepe Magique</h2>
  </div>
  <button id="viewOrdersBtn">Dashboard (Admins Only)</button>
</header>

<section class="banner"></section>

<h1>Our Special Menu ‚ù§Ô∏è</h1>

<main>
  <div class="menu">
    <div class="item">
      <img src="images/menu-1.jpg" alt="French Crepe">
      <h2>French Crepe ‚Äì ·üõ3500</h2>
      <button onclick="addToCart('French Crepe', 3500)">Add to Order</button>
    </div>
    <div class="item">
      <img src="images/menu-2.jpg" alt="Buchimgae">
      <h2>Buchimgae ‚Äì ·üõ6000</h2>
      <button onclick="addToCart('Buchimgae', 6000)">Add to Order</button>
    </div>
  </div>

  <div class="cart">
    <h2>Your Order</h2>
    <div id="cartItems"></div>
    <p><strong>Total: ·üõ<span id="cartTotal">0</span></strong></p>
    <input id="customerName" placeholder="Your Name">
    <input id="customerPhone" placeholder="Phone Number">
    <select id="yearSelect">
      <option value="">Select Year</option>
      <option>IP Student</option><option>Year 1</option><option>Year 2</option>
      <option>Year 3</option><option>Year 4</option><option>Staff</option>
    </select>
    <select id="pickupTime">
      <option value="">Pickup Time</option>
      <option>12:00-1:00pm</option><option>5:00-6:00pm</option>
    </select>
    <button class="submit-btn" onclick="submitOrder()">Submit Order</button>
    <p id="thankyouMsg" style="display:none;color:green;text-align:center;">Thank you! Your order was placed.</p>
  </div>
</main>

<footer>¬© 2025 Crepe Magique | Made with ‚ù§Ô∏è</footer>

<!-- üî• Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB6DxMKy1y28t4xtvw0SMcx3K4pivB7grw",
    authDomain: "crepe-magique.firebaseapp.com",
    databaseURL: "https://crepe-magique-default-rtdb.firebaseio.com",
    projectId: "crepe-magique",
    storageBucket: "crepe-magique.firebasestorage.app",
    messagingSenderId: "175773010517",
    appId: "1:175773010517:web:170168816a70efa825a2dc"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  window.db = db;
</script>

<script>
let cart = [];

function addToCart(item, price) {
  const existing = cart.find(i => i.item === item);
  if (existing) existing.quantity++;
  else cart.push({ item, price, quantity: 1 });
  renderCart();
}

function renderCart() {
  const cartDiv = document.getElementById('cartItems');
  if (cart.length === 0) {
    cartDiv.innerHTML = '';
    document.getElementById('cartTotal').textContent = 0;
    return;
  }
  cartDiv.innerHTML = cart.map((i, idx) => `
    <div style="display:flex;justify-content:space-between;">
      <span>${i.item} √ó${i.quantity}</span>
      <span>·üõ${i.price * i.quantity}</span>
    </div>`).join('');
  document.getElementById('cartTotal').textContent = cart.reduce((t, i) => t + i.price * i.quantity, 0);
}

function submitOrder() {
  const name = document.getElementById('customerName').value.trim();
  const phone = document.getElementById('customerPhone').value.trim();
  const year = document.getElementById('yearSelect').value;
  const pickupTime = document.getElementById('pickupTime').value;
  if (!name || !phone || !year || !pickupTime || cart.length === 0) {
    alert('Please fill out all fields and add items.');
    return;
  }

  const order = { name, phone, year, pickupTime, cart, time: new Date().toLocaleString() };

  // Save order to Firebase
  const db = window.db;
  import("https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js").then(({ ref, push }) => {
    push(ref(db, "orders"), order)
      .then(() => {
        document.getElementById('thankyouMsg').style.display = 'block';
        cart = [];
        renderCart();
        setTimeout(()=>document.getElementById('thankyouMsg').style.display='none',3000);
      })
      .catch(err => alert("Error saving order: " + err.message));
  });
}

document.getElementById('viewOrdersBtn').addEventListener('click', () => {
  const pass = prompt("Enter admin password:");
  if (pass === "Patricia") window.location.href = "dashboard.html";
});
</script>
</body>
</html>
